<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>林与鹤</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/blog/logo.jpg">
    <meta name="description" content="林与鹤的个人博客">
    
    <link rel="preload" href="/blog/assets/css/0.styles.d2aea499.css" as="style"><link rel="preload" href="/blog/assets/js/app.cef67319.js" as="script"><link rel="preload" href="/blog/assets/js/3.49a7d45d.js" as="script"><link rel="preload" href="/blog/assets/js/45.604cd73e.js" as="script"><link rel="prefetch" href="/blog/assets/js/1.672475c2.js"><link rel="prefetch" href="/blog/assets/js/10.11ec9c1e.js"><link rel="prefetch" href="/blog/assets/js/11.febdacc1.js"><link rel="prefetch" href="/blog/assets/js/12.7e9be204.js"><link rel="prefetch" href="/blog/assets/js/13.e5cd540f.js"><link rel="prefetch" href="/blog/assets/js/14.90680b82.js"><link rel="prefetch" href="/blog/assets/js/15.db41dbcf.js"><link rel="prefetch" href="/blog/assets/js/16.cf343a58.js"><link rel="prefetch" href="/blog/assets/js/17.0ad7f9ce.js"><link rel="prefetch" href="/blog/assets/js/18.d276c7cd.js"><link rel="prefetch" href="/blog/assets/js/19.ec449d9b.js"><link rel="prefetch" href="/blog/assets/js/20.853c8dc6.js"><link rel="prefetch" href="/blog/assets/js/21.286706c6.js"><link rel="prefetch" href="/blog/assets/js/22.e7eae57d.js"><link rel="prefetch" href="/blog/assets/js/23.0594c59b.js"><link rel="prefetch" href="/blog/assets/js/24.bbc7c088.js"><link rel="prefetch" href="/blog/assets/js/25.1bde53bc.js"><link rel="prefetch" href="/blog/assets/js/26.f2865ebf.js"><link rel="prefetch" href="/blog/assets/js/27.baf145e6.js"><link rel="prefetch" href="/blog/assets/js/28.ed707b68.js"><link rel="prefetch" href="/blog/assets/js/29.65d3d541.js"><link rel="prefetch" href="/blog/assets/js/30.67bcb276.js"><link rel="prefetch" href="/blog/assets/js/31.479c4927.js"><link rel="prefetch" href="/blog/assets/js/32.8e2d01ec.js"><link rel="prefetch" href="/blog/assets/js/33.895280d2.js"><link rel="prefetch" href="/blog/assets/js/34.9da4a01e.js"><link rel="prefetch" href="/blog/assets/js/35.0525e91d.js"><link rel="prefetch" href="/blog/assets/js/36.62f61a0d.js"><link rel="prefetch" href="/blog/assets/js/37.3c4cc759.js"><link rel="prefetch" href="/blog/assets/js/38.c1b81460.js"><link rel="prefetch" href="/blog/assets/js/39.937d8fa2.js"><link rel="prefetch" href="/blog/assets/js/4.3bc93305.js"><link rel="prefetch" href="/blog/assets/js/40.61cf1f38.js"><link rel="prefetch" href="/blog/assets/js/41.aa6cbf4c.js"><link rel="prefetch" href="/blog/assets/js/42.cea07671.js"><link rel="prefetch" href="/blog/assets/js/43.ded13cc3.js"><link rel="prefetch" href="/blog/assets/js/44.e537eb05.js"><link rel="prefetch" href="/blog/assets/js/46.d43dca68.js"><link rel="prefetch" href="/blog/assets/js/47.578c11fb.js"><link rel="prefetch" href="/blog/assets/js/48.4c97f01b.js"><link rel="prefetch" href="/blog/assets/js/49.73490f5d.js"><link rel="prefetch" href="/blog/assets/js/5.26989508.js"><link rel="prefetch" href="/blog/assets/js/6.6c45eddb.js"><link rel="prefetch" href="/blog/assets/js/7.bd147036.js"><link rel="prefetch" href="/blog/assets/js/8.a9fc2f87.js"><link rel="prefetch" href="/blog/assets/js/9.e365efc4.js">
    <link rel="stylesheet" href="/blog/assets/css/0.styles.d2aea499.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/blog/" class="home-link router-link-active"><!----> <span class="site-name">林与鹤</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/blog/" class="nav-link">
  关于我
</a></div><div class="nav-item"><a href="/blog/CSS/" class="nav-link">
  CSS
</a></div><div class="nav-item"><a href="/blog/JAVASCRIPT/" class="nav-link">
  JavaScript
</a></div><div class="nav-item"><a href="/blog/wxprogram/" class="nav-link">
  微信小程序
</a></div><div class="nav-item"><a href="/blog/vue/" class="nav-link">
  vue
</a></div><div class="nav-item"><a href="/blog/webGL/" class="nav-link router-link-active">
  webGL
</a></div><div class="nav-item"><a href="/blog/webpack/" class="nav-link">
  webpack
</a></div><div class="nav-item"><a href="/blog/gis/" class="nav-link">
  gis
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="app" class="dropdown-title"><span class="title">app</span> <span class="arrow down"></span></button> <button type="button" aria-label="app" class="mobile-dropdown-title"><span class="title">app</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/dCloud/" class="nav-link">
  DCloud
</a></li><li class="dropdown-item"><!----> <a href="/blog/apiCloud/" class="nav-link">
  ApiCloud
</a></li><li class="dropdown-item"><!----> <a href="/blog/electron/" class="nav-link">
  Electron
</a></li></ul></div></div><div class="nav-item"><a href="/blog/Business/" class="nav-link">
  商业项目
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/blog/" class="nav-link">
  关于我
</a></div><div class="nav-item"><a href="/blog/CSS/" class="nav-link">
  CSS
</a></div><div class="nav-item"><a href="/blog/JAVASCRIPT/" class="nav-link">
  JavaScript
</a></div><div class="nav-item"><a href="/blog/wxprogram/" class="nav-link">
  微信小程序
</a></div><div class="nav-item"><a href="/blog/vue/" class="nav-link">
  vue
</a></div><div class="nav-item"><a href="/blog/webGL/" class="nav-link router-link-active">
  webGL
</a></div><div class="nav-item"><a href="/blog/webpack/" class="nav-link">
  webpack
</a></div><div class="nav-item"><a href="/blog/gis/" class="nav-link">
  gis
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="app" class="dropdown-title"><span class="title">app</span> <span class="arrow down"></span></button> <button type="button" aria-label="app" class="mobile-dropdown-title"><span class="title">app</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/dCloud/" class="nav-link">
  DCloud
</a></li><li class="dropdown-item"><!----> <a href="/blog/apiCloud/" class="nav-link">
  ApiCloud
</a></li><li class="dropdown-item"><!----> <a href="/blog/electron/" class="nav-link">
  Electron
</a></li></ul></div></div><div class="nav-item"><a href="/blog/Business/" class="nav-link">
  商业项目
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>关于webGL</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/webGL/" aria-current="page" class="sidebar-link">介绍</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>基础篇</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/webGL/" aria-current="page" class="sidebar-link">灯光</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>教程</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/webGL/periodictable.html" aria-current="page" class="active sidebar-link">元素周期表</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><p><a href="https://herohql521.github.io/blog-demo/periodictable.html" target="_blank" rel="noopener noreferrer">demo<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <img src="/blog/img/periodictable_cover.png" alt=""></p> <h3 id="思路"><a href="#思路" class="header-anchor">#</a> 思路</h3> <p>把元素从某个位置，变化到另一位置。
元素初始化一个随机vector3坐标<br>
定义一个对象，存储想要变化的目标数组，用 tween.js 实现vector3从a位置变化到b位置</p> <div class="language- extra-class"><pre class="language-text"><code> var targets = { table: [], sphere: [], helix: [], grid: [] };
</code></pre></div><p>像元素周期表的排列没有规律，所以在 <b>数据组织</b> 中定制<br>
sphere（球体结构），需要用到数学球体坐标系的相关公式推导求得，下面会详细介绍<br>
helix（螺线结构）grid(格子), 也是用到数学方法求得</p> <h3 id="数据组织"><a href="#数据组织" class="header-anchor">#</a> 数据组织</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">//元素，介绍，质量，定制x的位置，定制y的位置</span>
<span class="token keyword">var</span> table <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token string">&quot;H&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Hydrogen&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;1.00794&quot;</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span>
  <span class="token string">&quot;He&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Helium&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;4.002602&quot;</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span>
  <span class="token string">&quot;Li&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Lithium&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;6.941&quot;</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span>
  <span class="token string">&quot;Be&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Beryllium&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;9.012182&quot;</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span>
  <span class="token string">&quot;B&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Boron&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;10.811&quot;</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span>
  <span class="token string">&quot;C&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Carbon&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;12.0107&quot;</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span>
  <span class="token string">&quot;N&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Nitrogen&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;14.0067&quot;</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span>
  <span class="token string">&quot;O&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Oxygen&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;15.9994&quot;</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span>
  <span class="token string">&quot;F&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Fluorine&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;18.9984032&quot;</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span>
  <span class="token string">&quot;Ne&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Neon&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;20.1797&quot;</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span>
  <span class="token string">&quot;Na&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Sodium&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;22.98976...&quot;</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span>
  <span class="token string">&quot;Mg&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Magnesium&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;24.305&quot;</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span>
  <span class="token string">&quot;Al&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Aluminium&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;26.9815386&quot;</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span>
  <span class="token string">&quot;Si&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Silicon&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;28.0855&quot;</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span>
  <span class="token string">&quot;P&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Phosphorus&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;30.973762&quot;</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span>
  ……
<span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="three-css3dobject-初始化dom元素-组织table数组"><a href="#three-css3dobject-初始化dom元素-组织table数组" class="header-anchor">#</a> THREE.CSS3DObject 初始化dom元素，组织table数组</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">for</span> <span class="token punctuation">(</span> <span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> table<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i <span class="token operator">+=</span> <span class="token number">5</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token keyword">var</span> element <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span> <span class="token string">'div'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
    element<span class="token punctuation">.</span>className <span class="token operator">=</span> <span class="token string">'element'</span><span class="token punctuation">;</span>
    element<span class="token punctuation">.</span>style<span class="token punctuation">.</span>backgroundColor <span class="token operator">=</span> <span class="token string">'rgba(0,127,127,'</span> <span class="token operator">+</span> <span class="token punctuation">(</span> Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">0.5</span> <span class="token operator">+</span> <span class="token number">0.25</span> <span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">')'</span><span class="token punctuation">;</span>

    <span class="token keyword">var</span> number <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span> <span class="token string">'div'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
    number<span class="token punctuation">.</span>className <span class="token operator">=</span> <span class="token string">'number'</span><span class="token punctuation">;</span>
    number<span class="token punctuation">.</span>textContent <span class="token operator">=</span> <span class="token punctuation">(</span>i<span class="token operator">/</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
    element<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span> number <span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">var</span> symbol <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span> <span class="token string">'div'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
    symbol<span class="token punctuation">.</span>className <span class="token operator">=</span> <span class="token string">'symbol'</span><span class="token punctuation">;</span>
    symbol<span class="token punctuation">.</span>textContent <span class="token operator">=</span> table<span class="token punctuation">[</span> i <span class="token punctuation">]</span><span class="token punctuation">;</span>
    element<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span> symbol <span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">var</span> details <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span> <span class="token string">'div'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
    details<span class="token punctuation">.</span>className <span class="token operator">=</span> <span class="token string">'details'</span><span class="token punctuation">;</span>
    details<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> table<span class="token punctuation">[</span> i <span class="token operator">+</span> <span class="token number">1</span> <span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">'&lt;br&gt;'</span> <span class="token operator">+</span> table<span class="token punctuation">[</span> i <span class="token operator">+</span> <span class="token number">2</span> <span class="token punctuation">]</span><span class="token punctuation">;</span>
    element<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span> details <span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token comment">//初始化随机位置</span>
    <span class="token keyword">var</span> object <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>CSS3DObject</span><span class="token punctuation">(</span> element <span class="token punctuation">)</span><span class="token punctuation">;</span>
    object<span class="token punctuation">.</span>position<span class="token punctuation">.</span>x <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">4000</span> <span class="token operator">-</span> <span class="token number">2000</span><span class="token punctuation">;</span> <span class="token comment">//[-2000,4000)</span>
    object<span class="token punctuation">.</span>position<span class="token punctuation">.</span>y <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">4000</span> <span class="token operator">-</span> <span class="token number">2000</span><span class="token punctuation">;</span>
    object<span class="token punctuation">.</span>position<span class="token punctuation">.</span>z <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">4000</span> <span class="token operator">-</span> <span class="token number">2000</span><span class="token punctuation">;</span>
    scene<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span> object <span class="token punctuation">)</span><span class="token punctuation">;</span>

    objects<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span> object <span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//table数组 ---元素周期表的排列</span>

    <span class="token keyword">var</span> object <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Object3D</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    object<span class="token punctuation">.</span>position<span class="token punctuation">.</span>x <span class="token operator">=</span> <span class="token punctuation">(</span> table<span class="token punctuation">[</span> i <span class="token operator">+</span> <span class="token number">3</span> <span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">140</span> <span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1330</span><span class="token punctuation">;</span>
    object<span class="token punctuation">.</span>position<span class="token punctuation">.</span>y <span class="token operator">=</span> <span class="token operator">-</span> <span class="token punctuation">(</span> table<span class="token punctuation">[</span> i <span class="token operator">+</span> <span class="token number">4</span> <span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">180</span> <span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">990</span><span class="token punctuation">;</span>

    targets<span class="token punctuation">.</span>table<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span> object <span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span>
</code></pre></div><p>从table数组可以看出，table[ i + 3 ] 和 table[ i + 4 ] 确定了元素周期表中每个元素的 xy坐标，z坐标默认是0。</p> <h3 id="sphere数组"><a href="#sphere数组" class="header-anchor">#</a> sphere数组</h3> <p>sphere坐标的计算用到了一些数学知识。</p> <h4 id="球面坐标"><a href="#球面坐标" class="header-anchor">#</a> 球面坐标</h4> <p>球坐标系是三维坐标系的一种，用以确定三维空间中点、线、面以及体的位置，它以坐标原点为参考点，由方位角、仰角和距离构成。球坐标系在地理学、天文学中都有着广泛应用。</p> <h4 id="定义"><a href="#定义" class="header-anchor">#</a> 定义</h4> <p>在数学里，球坐标系是一种利用球坐标（r，φ，θ）  表示一个点 p 在三维空间的位置的三维正交坐标系。下图显示了球坐标的几何意义：原点与点 P 之间的径向距离 r ，原点到点 P 的连线与正 z-轴之间的天顶角  θ以及原点到点 P 的连线，在 xy-平面的投影线，与正 x-轴之间的方位角 φ 。</p> <img src="/blog/img/sphere2.png" alt="sphere"> <h4 id="例解"><a href="#例解" class="header-anchor">#</a> 例解</h4> <p>假设P（x，y，z）为空间内一点，则点P也可用这样三个有次序的数(r，θ，φ)来确定，其中r为原点O与点P间的距离；θ为有向线段OP与z轴正向的夹角；φ为从正z轴来看自x轴按逆时针方向转到OM所转过的角，这里M为点P在xOy面上的投影；。这样的三个数r，θ，φ叫做点P的球面坐标，显然，这里r，θ，φ的变化范围为r∈[0,+∞)，θ∈[0, π]， φ∈[0,2π] ，如图1所示。
当r,θ或φ分别为常数时,可以表示如下特殊曲面:r = 常数，即以原点为心的球面；θ= 常数，即以原点为顶点、z轴为轴的圆锥面；φ= 常数，即过z轴的半平面。</p> <h4 id="转换"><a href="#转换" class="header-anchor">#</a> 转换</h4> <p>球坐标系(r,θ,φ)与直角坐标系(x,y,z)的转换关系:</p> <blockquote><p>x=rsinθcosφ</p></blockquote> <blockquote><p>y=rsinθsinφ.</p></blockquote> <blockquote><p>z=rcosθ.</p></blockquote> <p>反之，直角坐标系(x,y,z)与球坐标系(r,θ,φ)的转换关系为:</p> <img src="/blog/img/sphere.png" alt="sphere"> <h4 id="代码"><a href="#代码" class="header-anchor">#</a> 代码</h4> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> vector <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Vector3</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">for</span> <span class="token punctuation">(</span> <span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> l <span class="token operator">=</span> objects<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i <span class="token operator">&lt;</span> l<span class="token punctuation">;</span> i <span class="token operator">++</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> phi <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">acos</span><span class="token punctuation">(</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token operator">+</span> <span class="token punctuation">(</span> <span class="token number">2</span> <span class="token operator">*</span> i <span class="token punctuation">)</span> <span class="token operator">/</span> l <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//[-1，1]反余弦返回0-PI之间的弧度</span>
    <span class="token keyword">var</span> theta <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">sqrt</span><span class="token punctuation">(</span> l <span class="token operator">*</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token punctuation">)</span> <span class="token operator">*</span> phi<span class="token punctuation">;</span> <span class="token comment">//[0,20PI]</span>

    <span class="token keyword">var</span> object <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Object3D</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    object<span class="token punctuation">.</span>position<span class="token punctuation">.</span>x <span class="token operator">=</span> <span class="token number">800</span> <span class="token operator">*</span> Math<span class="token punctuation">.</span><span class="token function">cos</span><span class="token punctuation">(</span> theta <span class="token punctuation">)</span> <span class="token operator">*</span> Math<span class="token punctuation">.</span><span class="token function">sin</span><span class="token punctuation">(</span> phi <span class="token punctuation">)</span><span class="token punctuation">;</span>
    object<span class="token punctuation">.</span>position<span class="token punctuation">.</span>y <span class="token operator">=</span> <span class="token number">800</span> <span class="token operator">*</span> Math<span class="token punctuation">.</span><span class="token function">sin</span><span class="token punctuation">(</span> theta <span class="token punctuation">)</span> <span class="token operator">*</span> Math<span class="token punctuation">.</span><span class="token function">sin</span><span class="token punctuation">(</span> phi <span class="token punctuation">)</span><span class="token punctuation">;</span>
    object<span class="token punctuation">.</span>position<span class="token punctuation">.</span>z <span class="token operator">=</span> <span class="token number">800</span> <span class="token operator">*</span> Math<span class="token punctuation">.</span><span class="token function">cos</span><span class="token punctuation">(</span> phi <span class="token punctuation">)</span><span class="token punctuation">;</span>
    vector<span class="token punctuation">.</span><span class="token function">copy</span><span class="token punctuation">(</span> object<span class="token punctuation">.</span>position <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">multiplyScalar</span><span class="token punctuation">(</span> <span class="token number">1</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
    object<span class="token punctuation">.</span><span class="token function">lookAt</span><span class="token punctuation">(</span> vector <span class="token punctuation">)</span><span class="token punctuation">;</span>

    targets<span class="token punctuation">.</span>sphere<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span> object <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>r是确定的，所以计算出 phi theta，就能确定球面上的位置。</p> <h3 id="helix"><a href="#helix" class="header-anchor">#</a> helix</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code> <span class="token comment">// helix</span>
<span class="token keyword">var</span> vector <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Vector3</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">for</span> <span class="token punctuation">(</span> <span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> l <span class="token operator">=</span> objects<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i <span class="token operator">&lt;</span> l<span class="token punctuation">;</span> i <span class="token operator">++</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>

  <span class="token keyword">var</span> phi <span class="token operator">=</span> i <span class="token operator">*</span> <span class="token number">0.175</span> <span class="token operator">+</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span><span class="token punctuation">;</span>

  <span class="token keyword">var</span> object <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Object3D</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  object<span class="token punctuation">.</span>position<span class="token punctuation">.</span>x <span class="token operator">=</span> <span class="token number">900</span> <span class="token operator">*</span> Math<span class="token punctuation">.</span><span class="token function">sin</span><span class="token punctuation">(</span> phi <span class="token punctuation">)</span><span class="token punctuation">;</span>
  object<span class="token punctuation">.</span>position<span class="token punctuation">.</span>y <span class="token operator">=</span> <span class="token operator">-</span> <span class="token punctuation">(</span> i <span class="token operator">*</span> <span class="token number">8</span> <span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">450</span><span class="token punctuation">;</span>
  object<span class="token punctuation">.</span>position<span class="token punctuation">.</span>z <span class="token operator">=</span> <span class="token number">900</span> <span class="token operator">*</span> Math<span class="token punctuation">.</span><span class="token function">cos</span><span class="token punctuation">(</span> phi <span class="token punctuation">)</span><span class="token punctuation">;</span>

  vector<span class="token punctuation">.</span>x <span class="token operator">=</span> object<span class="token punctuation">.</span>position<span class="token punctuation">.</span>x <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">;</span>
  vector<span class="token punctuation">.</span>y <span class="token operator">=</span> object<span class="token punctuation">.</span>position<span class="token punctuation">.</span>y<span class="token punctuation">;</span>
  vector<span class="token punctuation">.</span>z <span class="token operator">=</span> object<span class="token punctuation">.</span>position<span class="token punctuation">.</span>z <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">;</span>

  object<span class="token punctuation">.</span><span class="token function">lookAt</span><span class="token punctuation">(</span> vector <span class="token punctuation">)</span><span class="token punctuation">;</span>

  targets<span class="token punctuation">.</span>helix<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span> object <span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span>
</code></pre></div><h3 id="grid"><a href="#grid" class="header-anchor">#</a> grid</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// grid</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span> <span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> objects<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i <span class="token operator">++</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token keyword">var</span> object <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Object3D</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    object<span class="token punctuation">.</span>position<span class="token punctuation">.</span>x <span class="token operator">=</span> <span class="token punctuation">(</span> <span class="token punctuation">(</span> i <span class="token operator">%</span> <span class="token number">5</span> <span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">400</span> <span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">800</span><span class="token punctuation">;</span>
    object<span class="token punctuation">.</span>position<span class="token punctuation">.</span>y <span class="token operator">=</span> <span class="token punctuation">(</span> <span class="token operator">-</span> <span class="token punctuation">(</span> Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span> i <span class="token operator">/</span> <span class="token number">5</span> <span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">5</span> <span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">400</span> <span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">800</span><span class="token punctuation">;</span>
    object<span class="token punctuation">.</span>position<span class="token punctuation">.</span>z <span class="token operator">=</span> <span class="token punctuation">(</span> Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span> i <span class="token operator">/</span> <span class="token number">25</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">1000</span> <span class="token operator">-</span> <span class="token number">2000</span><span class="token punctuation">;</span>

    targets<span class="token punctuation">.</span>grid<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span> object <span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span>
</code></pre></div><h3 id="变形"><a href="#变形" class="header-anchor">#</a> 变形</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">//调用：  </span>
<span class="token function">transform</span><span class="token punctuation">(</span> targets<span class="token punctuation">.</span>sphere<span class="token punctuation">,</span> <span class="token number">2000</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">transform</span><span class="token punctuation">(</span> <span class="token parameter">targets<span class="token punctuation">,</span> duration</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>

  <span class="token constant">TWEEN</span><span class="token punctuation">.</span><span class="token function">removeAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">for</span> <span class="token punctuation">(</span> <span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> objects<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i <span class="token operator">++</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>

      <span class="token keyword">var</span> object <span class="token operator">=</span> objects<span class="token punctuation">[</span> i <span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token keyword">var</span> target <span class="token operator">=</span> targets<span class="token punctuation">[</span> i <span class="token punctuation">]</span><span class="token punctuation">;</span>

      <span class="token keyword">new</span> <span class="token class-name">TWEEN<span class="token punctuation">.</span>Tween</span><span class="token punctuation">(</span> object<span class="token punctuation">.</span>position <span class="token punctuation">)</span>
          <span class="token punctuation">.</span><span class="token function">to</span><span class="token punctuation">(</span> <span class="token punctuation">{</span> x<span class="token operator">:</span> target<span class="token punctuation">.</span>position<span class="token punctuation">.</span>x<span class="token punctuation">,</span> y<span class="token operator">:</span> target<span class="token punctuation">.</span>position<span class="token punctuation">.</span>y<span class="token punctuation">,</span> z<span class="token operator">:</span> target<span class="token punctuation">.</span>position<span class="token punctuation">.</span>z <span class="token punctuation">}</span><span class="token punctuation">,</span> Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> duration <span class="token operator">+</span> duration <span class="token punctuation">)</span>
          <span class="token punctuation">.</span><span class="token function">easing</span><span class="token punctuation">(</span> <span class="token constant">TWEEN</span><span class="token punctuation">.</span>Easing<span class="token punctuation">.</span>Exponential<span class="token punctuation">.</span>InOut <span class="token punctuation">)</span>
          <span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token keyword">new</span> <span class="token class-name">TWEEN<span class="token punctuation">.</span>Tween</span><span class="token punctuation">(</span> object<span class="token punctuation">.</span>rotation <span class="token punctuation">)</span>
          <span class="token punctuation">.</span><span class="token function">to</span><span class="token punctuation">(</span> <span class="token punctuation">{</span> x<span class="token operator">:</span> target<span class="token punctuation">.</span>rotation<span class="token punctuation">.</span>x<span class="token punctuation">,</span> y<span class="token operator">:</span> target<span class="token punctuation">.</span>rotation<span class="token punctuation">.</span>y<span class="token punctuation">,</span> z<span class="token operator">:</span> target<span class="token punctuation">.</span>rotation<span class="token punctuation">.</span>z <span class="token punctuation">}</span><span class="token punctuation">,</span> Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> duration <span class="token operator">+</span> duration <span class="token punctuation">)</span>
          <span class="token punctuation">.</span><span class="token function">easing</span><span class="token punctuation">(</span> <span class="token constant">TWEEN</span><span class="token punctuation">.</span>Easing<span class="token punctuation">.</span>Exponential<span class="token punctuation">.</span>InOut <span class="token punctuation">)</span>
          <span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token punctuation">}</span>

  <span class="token keyword">new</span> <span class="token class-name">TWEEN<span class="token punctuation">.</span>Tween</span><span class="token punctuation">(</span> <span class="token keyword">this</span> <span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">to</span><span class="token punctuation">(</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> duration <span class="token operator">*</span> <span class="token number">2</span> <span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">onUpdate</span><span class="token punctuation">(</span> render <span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span>
</code></pre></div><h3 id="初始化"><a href="#初始化" class="header-anchor">#</a> 初始化</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code>camera <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>PerspectiveCamera</span><span class="token punctuation">(</span> <span class="token number">40</span><span class="token punctuation">,</span> window<span class="token punctuation">.</span>innerWidth <span class="token operator">/</span> window<span class="token punctuation">.</span>innerHeight<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">10000</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
camera<span class="token punctuation">.</span>position<span class="token punctuation">.</span>z <span class="token operator">=</span> <span class="token number">3000</span><span class="token punctuation">;</span>
camera<span class="token punctuation">.</span>position<span class="token punctuation">.</span>y <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
scene <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Scene</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="渲染及循环"><a href="#渲染及循环" class="header-anchor">#</a> 渲染及循环</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">animate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

  <span class="token function">requestAnimationFrame</span><span class="token punctuation">(</span> animate <span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token constant">TWEEN</span><span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  controls<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

  renderer<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span> scene<span class="token punctuation">,</span> camera <span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span>
</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/blog/webGL/" class="prev router-link-active">
        灯光
      </a></span> <!----></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/blog/assets/js/app.cef67319.js" defer></script><script src="/blog/assets/js/3.49a7d45d.js" defer></script><script src="/blog/assets/js/45.604cd73e.js" defer></script>
  </body>
</html>
